<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3SecondsShutter for RICOH THETA S (3.0)</title>
<script src="/theta_s/js/jatitle.js">3秒シャッター for RICOH THETA S (3.0)</script>
<script src="/theta_s/js/bookmarkletcode.js">
javascript:
(function(g,k,u,i,d){
  g='RICOH THETA S';
  k='3SecondsShutter for '+g+' (3.0)';
  u='http://192.168.1.1/osc/';
  i=u+'info';
  if(location.href.indexOf(i)!=0){
    alert('Run this bookmarklet again after the URL below will be opened. (Wi-Fi connection with '+g+' is required.)\n\n'+i);
    location=i;
    return;
  }
  d=document;
  d.open();
  d.write('
    <meta name="viewport" content="width=320,initial-scale=1,user-scalable=no">
    <title>'+k+'<\/title>
    <style>
    *{width:100%25;height:100%25;margin:0;border:0;}
    <\/style>
    <iframe><\/iframe>
  ');
  d.close();
  d.querySelector('iframe').srcdoc='
    <style>
    body{user-select:none;-webkit-user-select:none;font-family:sans-serif;}
    h1{font:initial;}
    #b{
      position:fixed;top:50%25;left:50%25;transform:translate(-50%25,-50%25);width:300px;height:300px;padding:0;
      border:10px solid #6432c8;border-radius:50%25;background:#f0f0f0;color:#757575;font-size:150px;
    }
    #b:active{background:#e1e1e1;}
    #b:disabled{border-color:#757575;}
    #n{position:fixed;right:8px;bottom:8px;}
    <\/style>
    <h1>'+k+' by <a href="https://twitter.com/shikaku1068" target="_blank">shikaku1068<\/a><\/h1>
    <button id="b" disabled>&Theta;<\/button>
    <div id="n"><\/div>
    <script>
    var d,b,n,x,q,t,p,r,i,m,v,a,y,c,e;
    d=document;
    b=d.getElementById("b");
    n=d.getElementById("n");
    q=[];
    x=new XMLHttpRequest;
    x.timeout=2000;
    x.onloadend=function(){
      if(x.status==200){
        t.s&&t.s(JSON.parse(x.responseText));
      }
      else{
        t.e&&t.e();
      }
      t.f&&t.f();
      t=0;
      q.length&&p();
    };
    p=function(){
      t=q.shift();
      x.open("POST","'+u+'commands/"+(t.o?"status":"execute"));
      x.setRequestHeader("Content-Type","application/json;charset=utf-8");
      x.setRequestHeader("Accept","application/json");
      x.send(JSON.stringify(t.j));
    };
    r=function(o,j,s,e,f){
      q.push({o:o,j:j,s:s,e:e,f:f});
      t||p();
    };
    c=0;
    onfocus=function(){
      a=1;
      v=0;
    };
    onblur=function(){
      a=0;
      b.disabled=1;
    };
    ontouchmove=function(e){e.preventDefault();};
    b.onclick=function(){
      b.disabled=1;
      e=3;
      (function l(){
        if(e>0){
          b.innerHTML=e--;
          setTimeout(l,1000);
        }
        else{
          r(
            0,{name:"camera.takePicture",parameters:{sessionId:i}},
            function s(o){
              if(o.progress){
                c++;
                n.innerHTML=c;
                setTimeout(function(){r(1,{id:o.id},s,0,function(){c--;n.innerHTML=(c?c:"");});},1000);
              }
            }
          );
          b.innerHTML="&Theta;";
          setTimeout(function(){v&&(b.disabled=0);},1000);
        }
      })();
    };
    b.ontouchend=function(){b.click();};
    (function l(){
      if(a&&!y&&!v){
        y=1;
        r(
          0,{name:"camera.startSession"},
          function(o,r){
            if(r=o.results){
              i=r.sessionId;
              v=1;
              clearTimeout(m);
              m=setTimeout(function(){v=0;},r.timeout*1000/2);
              b.disabled=0;
            }
          },
          function(){
            v=0;
            b.disabled=1;
          },
          function(){y=0;}
        );
      }
      setTimeout(l,1000);
    })();
    focus();
    <\/script>
  ';
})();
</script>
<script src="/theta_s/js/analyticstracking.js"></script>
</head>
<body>
</body>
</html>
